A0832 EQU 0600H

CODE SEGMENT
	ASSUME CS:CODE

START:
	MOV AX,0000H
	MOV DS,AX
	MOV AX,OFFSET MIR6
	MOV SI,0038H
	MOV [SI],AX
	INC SI
	INC SI
	MOV AX,CS
	MOV [SI],AX
	
	CLI
	MOV AL,11H
	OUT 20H,AL
	MOV AL,08H
	OUT 21H,AL
	MOV AL,04H
	OUT 21H,AL
	MOV AL,03H
	OUT 21H,AL
	MOV AL,0AFH
	OUT 21H,AL
	STI
	MOV BL,00H
	
A1:
	CMP BL,00H
	JZ JUCHI
	CMP BL,01H
	JZ JUXING
	CMP BL,02H
	JZ SANJIAO
	JMP JIETI
	
JUCHI:
	MOV DX,A0832
	MOV AL,00H
JC1:
	OUT DX,AL
	CALL DELAY1
	CMP AL,0FFH
	JE A1
	INC AL
	JMP JC1

JUXING:
	MOV DX,A0832
	MOV AL,00H
	OUT DX,AL
	CALL DELAY2
	MOV AL,0FFH
	OUT DX,AL
	CALL DELAY2
	JMP A1

SANJIAO:
	MOV AL,00H
SJ1:
	MOV DX,A0832
	OUT DX,AL
	CALL DELAY3
	CMP AL,0FFH
	JE SJ2
	INC AL
	JMP SJ1
SJ2:
	MOV DX,A0832
	OUT DX,AL
	CALL DELAY3
	CMP AL,00H
	JE A1
	DEC AL
	JMP SJ2

JIETI:
	MOV AX,0FEH
	MOV CL,05H
	DIV CL
	MOV CL,AL
	MOV CH,00H
JT1:
	MOV AX,0000H
JT2:
	MOV DX,A0832
	OUT DX,AL
	CMP AX,0FFH
	JAE A1
	CALL DELAY4
	ADD AX,CX
	JMP JT2
	
DELAY1:
	PUSH AX
	PUSH CX
	MOV AX,01H
D1:
	MOV CX,0FFH
DD1:
	LOOP DD1
	DEC AX
	CMP AX,00H
	JNZ D1
	POP CX
	POP AX
	RET

DELAY2:
	PUSH AX
	PUSH CX
	MOV AX,7FH
D2:
	MOV CX,0FFH
DD2:
	LOOP DD2
	DEC AX
	CMP AX,00H
	JNZ D2
	POP CX
	POP AX
	RET

DELAY3:
	PUSH AX
	PUSH CX
	MOV AX,01H
D3:
	MOV CX,0FFH
DD3:
	LOOP DD3
	DEC AX
	CMP AX,00H
	JNZ D3
	POP CX
	POP AX
	RET

DELAY4:
	PUSH AX
	PUSH CX
	MOV AX,7FH
D4:
	MOV CX,0FFH
DD4:
	LOOP DD4
	DEC AX
	CMP AX,00H
	JNZ D4
	POP CX
	POP AX
	RET

MIR6:
	INC BL
	CMP BL,03H
	JA M
	IRET
M:
	MOV BL,00H
	IRET

CODE ENDS
	END START